<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Sign In - BizPilot</title>
	<script src="https://cdn.tailwindcss.com"></script>
	<script>
		tailwind.config = { theme: { extend: { colors: { accent: '#D01B22', primary: '#EAB84E', primaryLight: '#F2D495', primaryLightest: '#FFFCEE', ink: '#171208' } } } };
	</script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700;900&family=Noto+Serif+Bengali:wght@400;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="./styles.css">
	<style>
		@keyframes voiceBar {
			0%, 100% { transform: scaleY(0.3); }
			50% { transform: scaleY(1); }
		}
		.voice-bar { animation: voiceBar 1s ease-in-out infinite; transform-origin: bottom; }
		/* Page-specific header fixes: prevent overlap on small screens */
		.app-header .header-inner { height: auto; min-height: 64px; padding: 8px 0; flex-wrap: wrap; gap: 8px; }
		.app-header .main-nav { flex-wrap: wrap; }
	</style>
</head>
<body>
	<header class="app-header">
		<div class="container header-inner">
			<div class="brand">
				<img src="./assets/logo.png" alt="BizPilot" class="logo" style="object-fit:contain;">
				<div class="brand-text">
					<strong>BizPilot</strong>
					<span>AI Business Assistant</span>
				</div>
			</div>
			<nav class="main-nav flex items-center gap-3">
				<a href="./index.html#" class="nav-link">Home</a>
				<a href="./index.html#/wizard" class="nav-link">Try Wizard</a>
				<a href="./index.html#/dashboard" class="nav-btn">Dashboard</a>
			</nav>
		</div>
	</header>

	<main class="min-h-[calc(100vh-132px)] bg-gradient-to-b from-[color:var(--primaryLightest)] to-white pt-6 md:pt-10 relative overflow-hidden">
		<div class="absolute -top-10 -left-10 w-64 h-64 rounded-[40%] blur-3xl opacity-40" style="background:var(--primaryLight);"></div>
		<div class="absolute bottom-0 -right-16 w-72 h-72 rounded-[50%] blur-3xl opacity-30" style="background:var(--accent);"></div>
		<section class="view active">
			<div class="container py-6 md:py-10">
				<div class="mx-auto max-w-xl bg-white/90 backdrop-blur ring-1 ring-[color:var(--muted)] rounded-3xl shadow-2xl p-6 md:p-8">
					<div class="text-center mb-5">
						<div class="w-12 h-12 rounded-xl bg-[color:var(--accent)] text-white grid place-items-center mx-auto font-black">BP</div>
						<h2 class="mt-3 text-3xl md:text-4xl font-extrabold tracking-tight">Welcome to BizPilot</h2>
						<p class="text-[color:var(--ink-60)] text-sm md:text-base">Sign in to continue</p>
					</div>
					<form id="login-form" class="grid gap-3">
						<label class="grid gap-1">
							<span class="font-semibold">Email</span>
							<input type="email" id="email" placeholder="you@example.com" required class="px-3 py-2 border border-[color:var(--muted)] rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-[color:var(--primary)] shadow-sm">
						</label>
						<label class="grid gap-1">
							<span class="font-semibold">Password</span>
							<input type="password" id="password" placeholder="********" required class="px-3 py-2 border border-[color:var(--muted)] rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-[color:var(--primary)] shadow-sm">
						</label>
						<div class="flex items-center justify-between text-sm">
							<a href="#" class="text-[color:var(--accent)] font-semibold">Forgot password?</a>
						</div>
						<button type="submit" class="w-full py-2.5 rounded-lg bg-[color:var(--ink)] text-white font-bold">Sign In</button>
					</form>
					<p id="login-error" class="mt-2 text-sm text-red-600" style="display:none"></p>
					<p class="mt-2 text-sm text-[color:var(--ink-60)] text-center">Don't have an account? <a href="./signup.html" class="text-[color:var(--accent)] font-bold">Sign up</a></p>
					<div class="relative my-5 text-center">
						<div class="absolute inset-x-0 top-1/2 -translate-y-1/2 h-px bg-[color:var(--muted)]"></div>
						<span class="relative inline-block bg-white px-2 text-xs uppercase tracking-wide text-[color:var(--ink-60)]">Or continue with</span>
					</div>
					<div class="grid gap-3">
						<button id="google-signin" type="button" class="w-full py-2 rounded-md bg-white border border-[#dadce0] font-bold flex items-center justify-center gap-2">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="w-5 h-5"><path fill="#FFC107" d="M43.6 20.5H42V20H24v8h11.3C33.6 32.6 29.2 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3 0 5.7 1.1 7.8 3l5.7-5.7C34.6 6.1 29.6 4 24 4 16.1 4 9.2 8.5 6.3 14.7z"/><path fill="#FF3D00" d="M6.3 14.7l6.6 4.8C14.4 16.1 18.9 12 24 12c3 0 5.7 1.1 7.8 3l5.7-5.7C34.6 6.1 29.6 4 24 4 16.1 4 9.2 8.5 6.3 14.7z"/><path fill="#4CAF50" d="M24 44c5.1 0 9.8-1.9 13.3-5l-6.1-5.1C29 35.5 26.6 36 24 36c-5.1 0-9.4-3.3-10.9-7.9l-6.6 5.1C9.2 39.5 16.1 44 24 44z"/><path fill="#1976D2" d="M43.6 20.5H42V20H24v8h11.3c-1.3 3.9-5 8-11.3 8-5.1 0-9.4-3.3-10.9-7.9l-6.6 5.1C9.2 39.5 16.1 44 24 44c11.1 0 20-8.9 20-20 0-1.2-.1-2.3-.4-3.5z"/></svg>
							<span>Sign in with Google</span>
						</button>
						<div class="flex items-center justify-center gap-2">
							<button id="linkedin-signin" type="button" title="LinkedIn" aria-label="Sign in with LinkedIn" class="w-12 h-12 rounded-md bg-[#0a66c2] text-white grid place-items-center">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" class="w-5 h-5 fill-current"><path d="M100.28 448H7.4V148.9h92.88zm-46.44-340C24.1 108 0 83.9 0 54.59A53.62 53.62 0 0153.84 0C83.1 0 107.2 24.1 107.2 53.41c0 29.31-24.1 53.41-53.36 53.41zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.27-79.2-48.3 0-55.7 37.7-55.7 76.6V448h-92.7V148.9h88.9v40.8h1.3c12.4-23.6 42.5-48.4 87.4-48.4 93.5 0 110.7 61.5 110.7 141.3V448z"/></svg>
							</button>
							<button id="voice-signin" type="button" title="Voice" aria-label="Sign in with Voice" class="w-12 h-12 rounded-md bg-[color:var(--primary)] text-black grid place-items-center">
								<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" class="w-5 h-5 fill-current"><path d="M192 352c53 0 96-43 96-96V96c0-53-43-96-96-96s-96 43-96 96v160c0 53 43 96 96 96zm56-96c0 30.9-25.1 56-56 56s-56-25.1-56-56V96c0-30.9 25.1-56 56-56s56 25.1 56 56v160zm32-16c0 61.9-50.1 112-112 112S56 301.9 56 240H24c0 74.8 56.5 136.6 128 147.2V448H120c-13.3 0-24 10.7-24 24v16h192v-16c0-13.3-10.7-24-24-24H232v-60.8c71.5-10.6 128-72.4 128-147.2h-32z"/></svg>
							</button>
						</div>
					</div>
					<p id="voice-status" class="text-sm text-[color:var(--ink-60)]" style="display:none"></p>
					<!-- Removed Business Stage and Continue. Proceed after sign-in. -->
				</div>
			</div>
		</section>
	</main>

	<!-- Voice Listening Modal -->
	<div id="voice-modal" class="fixed inset-0 bg-black/50 hidden flex items-center justify-center z-50">
		<div class="bg-white rounded-2xl shadow-2xl p-6 w-full max-w-sm text-center">
			<h3 class="text-lg font-extrabold mb-2">Listening...</h3>
			<p class="text-[color:var(--ink-60)] text-sm mb-4">Say your passphrase to continue</p>
			<div class="flex items-end justify-center gap-1 h-16 mb-4">
				<div class="w-2 bg-[color:var(--accent)] rounded voice-bar" style="animation-delay:0ms; height: 80%;"></div>
				<div class="w-2 bg-[color:var(--primary)] rounded voice-bar" style="animation-delay:150ms; height: 60%;"></div>
				<div class="w-2 bg-[color:var(--accent)] rounded voice-bar" style="animation-delay:300ms; height: 90%;"></div>
				<div class="w-2 bg-[color:var(--primary)] rounded voice-bar" style="animation-delay:450ms; height: 50%;"></div>
				<div class="w-2 bg-[color:var(--accent)] rounded voice-bar" style="animation-delay:600ms; height: 75%;"></div>
			</div>
			<button id="voice-cancel" class="w-full py-2 rounded-md border border-[color:var(--muted)]">Cancel</button>
		</div>
	</div>

	<footer class="app-footer">
		<div class="container footer-inner">
			<span>Â© <span id="year"></span> BizPilot</span>
			<a href="#/privacy">Privacy</a>
			<a href="#/terms">Terms</a>
		</div>
	</footer>

	<script type="module">
		import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js';
		import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js';
		import { getAuth, GoogleAuthProvider, signInWithPopup, signInWithEmailAndPassword, setPersistence, browserLocalPersistence } from 'https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js';

		const firebaseConfig = {
			apiKey: 'AIzaSyCpyk5H3coipz0HBJzuCXsBhwYPCcj2Asc',
			authDomain: 'blzpilot.firebaseapp.com',
			projectId: 'blzpilot',
			storageBucket: 'blzpilot.firebasestorage.app',
			messagingSenderId: '697661556177',
			appId: '1:697661556177:web:17ab41202f66748e02ccf0',
			measurementId: 'G-YBJGYKE3N5'
		};

		const app = initializeApp(firebaseConfig);
		try { getAnalytics(app); } catch {}
		const auth = getAuth(app);
		try { await setPersistence(auth, browserLocalPersistence); } catch {}
		const provider = new GoogleAuthProvider();

		const googleBtn = document.getElementById('google-signin');
		if (googleBtn) {
			googleBtn.addEventListener('click', async () => {
				googleBtn.disabled = true;
				try {
					const result = await signInWithPopup(auth, provider);
					const user = result.user;
					const userData = { uid: user.uid, displayName: user.displayName, email: user.email, photoURL: user.photoURL };
					try {
						localStorage.setItem('bp_user', JSON.stringify(userData));
						if (!localStorage.getItem('bp_language')) localStorage.setItem('bp_language', 'en');
					} catch {}
					window.location.href = './index.html#/wizard';
				} catch (err) {
					alert('Google sign-in failed. Please try again.');
					googleBtn.disabled = false;
				}
			});
		}

		const loginForm = document.getElementById('login-form');
		const emailEl = document.getElementById('email');
		const passEl = document.getElementById('password');
		const errEl = document.getElementById('login-error');
		if (loginForm && emailEl && passEl && errEl) {
			loginForm.addEventListener('submit', async (e) => {
				e.preventDefault();
				errEl.style.display = 'none';
				const email = String(emailEl.value || '').trim();
				const password = String(passEl.value || '');
				try {
					const result = await signInWithEmailAndPassword(auth, email, password);
					const user = result.user;
					const userData = { uid: user.uid, displayName: user.displayName, email: user.email, photoURL: user.photoURL };
					try {
						localStorage.setItem('bp_user', JSON.stringify(userData));
						if (!localStorage.getItem('bp_language')) localStorage.setItem('bp_language', 'en');
					} catch {}
					window.location.href = './index.html#/wizard';
				} catch (err) {
					errEl.textContent = 'Invalid email or password.';
					errEl.style.display = '';
				}
			});
		}
	</script>
	<script src="./login.js"></script>
</body>
</html>


